"""
Тесты для валидатора целых чисел.

Этот модуль содержит тесты для функции validate_is_int, которая проверяет,
что переданное значение является целым числом (int). Тесты проверяют корректность
работы валидатора для различных сценариев.
"""

import pytest

from dh_bl_core.validators.exceptions import ValueIsNotIntException
from dh_bl_core.validators.number import validate_is_int


class TestIntValidators:
    """Тестовый класс для проверки валидаторов целых чисел."""

    def test_validate_is_int_valid(self):
        """Проверяет, что корректные целые числа проходят валидацию."""
        # Тестирование корректных целых чисел
        # Включая положительные, отрицательные и ноль
        valid_integers = [
            0,  # Ноль
            1,  # Положительное число
            -1,  # Отрицательное число
            42,  # Произвольное положительное
            -42,  # Произвольное отрицательное
            1000,  # Большое положительное
            -1000,  # Большое отрицательное
            2**31 - 1,  # Максимальное 32-битное целое
        ]

        for value in valid_integers:
            assert validate_is_int(value) == value

    def test_validate_is_int_invalid_type(self):
        """Проверяет, что значения нецелочисленных типов вызывают исключение."""
        # Тестирование значений различных типов, которые не являются int
        invalid_types = [
            "123",  # Строка, содержащая число
            "abc",  # Строка с буквами
            "",  # Пустая строка
            123.0,  # Дробное число (плавающая точка)
            123.5,  # Дробное число с дробной частью
            True,  # Булево значение (в Python bool является подклассом int, но мы тестируем поведение)
            False,  # Булево значение
            [],  # Пустой список
            [1, 2, 3],  # Непустой список
            {},  # Пустой словарь
            {"a": 1},  # Непустой словарь
            (),  # Пустой кортеж
            (1, 2),  # Непустой кортеж
            None,  # None
            object(),  # Объект
        ]

        for value in invalid_types:
            with pytest.raises(ValueIsNotIntException):
                validate_is_int(value)

    def test_validate_is_int_edge_cases(self):
        """Проверяет граничные случаи для валидации целых чисел."""
        # Тестирование граничных случаев
        # В Python int не имеет жестких ограничений, но тестируем некоторые экстремальные значения
        edge_cases = [
            -(2**31),  # Минимальное 32-битное целое
            2**63 - 1,  # Очень большое положительное число
            -(2**63),  # Очень большое отрицательное число
        ]

        for value in edge_cases:
            assert validate_is_int(value) == value

    def test_validate_is_int_return_value(self):
        """Проверяет, что функция возвращает переданное значение."""
        # Проверка, что функция возвращает именно переданное значение, а не преобразованное
        test_value = 42
        result = validate_is_int(test_value)

        # Проверяем значение и тип
        assert result == test_value
        assert isinstance(result, int)

        # Проверяем, что возвращаемое значение - это тот же объект (для неизменяемых типов)
        assert result is test_value
